_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g},jQuery(document).ready(function(i){function n(n){var e=i("input[name^=ninja_forms_field_"+n+"]"),t=jQuery(e).serializeFullArray();return t}console.log("Loaded"),nf_cl.getParam=function(i){for(var n in nf_cl.cr_param_groups)for(var e in nf_cl.cr_param_groups[n])if(nf_cl.cr_param_groups[n][e].id==i)return nf_cl.cr_param_groups[n][e];return null};var e=Backbone.View.extend({el:i("#nf_cl_conditions"),events:{"click .add-condition":"addCondition","click .delete-condition":"deleteCondition","click .add-cr":"addCriteria","click .delete-cr":"deleteCriteria","change .cr-param":"changeParam"},initialize:function(){_.bindAll(this,"render"),this.render()},render:function(){if("undefined"!=typeof nf_cl.conditions)for(id in nf_cl.conditions)r.render(id)},addCondition:function(n){n.preventDefault(),"DIV"==n.target.tagName?i(n.target).parent().hide():i(n.target).hide(),r.render("new")},deleteCondition:function(n){n.preventDefault(),i(n.target).parent().parent().parent().remove(),i(this.el).find(".nf-cl-add").show()},addCriteria:function(n){n.preventDefault();var e=i(n.target).data("cond-id"),t="new",a="",r="",l="==";o.conditionEl=i("#nf_cl_condition_"+e),o.renderCriteriaRow(e,t,nf_cl.cr_param_groups,a,r,l)},deleteCriteria:function(n){n.preventDefault(),targetEl=i(n.target).parent().parent(),i(targetEl).remove()},changeParam:function(n){n.preventDefault();var e=i(n.target).data("cr-id"),t=i(n.target).data("cond-id"),a=i(n.target).val(),r="",l="";if("new"==e)var c=i(n.target).data("num"),d="conditions["+t+"][criteria][new]["+c+"]",_="nf_cr_new_"+c;else var c="",d="conditions["+t+"][criteria]["+e+"]",_="nf_cr_"+e;o.renderCriteriaCompare(e,d,nf_cl.cr_param_groups,a,l,c,_),o.renderCriteriaValue(e,d,nf_cl.cr_param_groups,a,r,c,_);var f=nf_cl.getParam(a);"date"==f.type&&i(n.target).next().next().find("input").datepicker({dateFormat:ninja_forms_settings.date_format})}}),t=Backbone.View.extend({el:i("#nf_cl_conditions"),initialize:function(){_.bindAll(this,"render")},render:function(n){if("undefined"!=typeof nf_cl.conditions[n])var e=nf_cl.conditions[n].action,t=nf_cl.conditions[n].connector;else var e="",t="";var a=_.template(i("#tmpl-nf-cl-condition").html())({cond_id:n,action:e,connector:t});i(this.el).append(a),o.renderCriteriaRows(n)}}),a=Backbone.View.extend({conditionEl:"",initialize:function(){_.bindAll(this,"render")},renderCriteriaRows:function(n){if("new"==n)return!1;this.conditionEl=i("#nf_cl_condition_"+n);var e=nf_cl.conditions[n],t=e.criteria,a=this;_.each(t,function(i){var e=i.id,t=i.param,o=i.value,r=i.compare;a.renderCriteriaRow(n,e,nf_cl.cr_param_groups,t,o,r)})},renderCriteriaRow:function(n,e,t,a,o,r){if("new"==e)var l=i(this.conditionEl).find(".single-criteria").length,c="conditions["+n+"][criteria][new]["+l+"]",d="nf_cr_new_"+l,f="new-"+l;else var l="",c="conditions["+n+"][criteria]["+e+"]",d="nf_cr_"+e,f=e;var s=_.template(i("#tmpl-nf-cl-criteria").html())({cr_id:e,cr_name:c,param_groups:t,selected_param:a,value:o,compare:r,num:l,div_id:d,data_id:f,cond_id:n});i(this.conditionEl).find(".nf-cl-criteria").append(s),this.renderCriteriaCompare(e,c,t,a,r,l,d),this.renderCriteriaValue(e,c,t,a,o,l,d)},renderCriteriaCompare:function(n,e,t,a,o,r,l){var c=i("#"+l).find(".cr-compare"),d=_.template(i("#tmpl-nf-cl-criteria-compare").html())({cr_id:n,cr_name:e,param_groups:t,selected_param:a,compare:o,nf_cl:nf_cl});i(c).html(d)},renderCriteriaValue:function(n,e,t,a,o,r,l){var c=i("#"+l).find(".cr-value"),d=_.template(i("#tmpl-nf-cl-criteria-value").html())({cr_id:n,cr_name:e,param_groups:t,selected_param:a,value:o,num:r,nf_cl:nf_cl});i(c).html(d);var f=nf_cl.getParam(a);f&&"date"==f.type&&i(c).find("input").datepicker({dateFormat:ninja_forms_settings.date_format})}}),o=new a,r=new t;new e;i(document).on("change",".ninja-forms-field-list-show-value",function(){var n=this.id.replace("ninja_forms_field_","");n=n.replace("_list_show_value","");var e=new Object;this.checked?(i(".ninja-forms-field-"+n+"-list-option-value").each(function(){var t=this.id.replace("ninja_forms_field_"+n+"_list_option_","");t=t.replace("_value_span",""),e[t]=i(this).children(".ninja-forms-field-list-option-value").val()}),i(".ninja-forms-field-"+n+"-list-option-value").show(),i(".ninja-forms-field-conditional-cr-field").each(function(){this.value==n&&i(this).nextElementInDom(".ninja-forms-field-conditional-cr-value-list:first").children("option").each(function(){this.value=e[this.title]})}),i(".ninja-forms-field-"+n+"-conditional-value").each(function(){i(this).children("option").each(function(){this.value=e[this.title]})})):(i("#ninja_forms_field_"+n+"_list_options").children(".ninja-forms-field-"+n+"-list-option").find(".ninja-forms-field-list-option-label").each(function(){var t=i(this).parent().parent().parent().parent().parent().prop("id"),a=t.replace("ninja_forms_field_"+n+"_list_option_","");e[a]=this.value}),i(".ninja-forms-field-conditional-cr-field").each(function(){this.value==n&&i(this).nextElementInDom(".ninja-forms-field-conditional-cr-value-list:first").children("option").each(function(){this.value=e[this.title]})}),i(".ninja-forms-field-"+n+"-conditional-value").each(function(){i(this).children("option").each(function(){this.value=e[this.title]})}),i(".ninja-forms-field-"+n+"-list-option-value").hide())}),i(document).on("change",".ninja-forms-field-conditional-action",function(){var e=this.id.replace("action","value"),t=(this.id.replace("action","value_label"),i("#_form_id").val()),a=i(this).parent().parent().attr("name"),o=(i("#ninja_forms_field_"+a+"_conditional_value_type").val(),i("#ninja_forms_field_"+a+"_list_show_value").prop("checked")),r=i(".ninja-forms-field-"+a+"-conditional").length;r--;var l=this.value,c=n(a);i.post(ajaxurl,{form_id:t,field_id:a,x:r,action_slug:l,field_data:c,action:"ninja_forms_change_action"},function(n){i("#ninja_forms_field_"+a+"_"+r+"_value_span").prop("innerHTML",n.new_html),"list"==n.new_type&&(i("#"+e).children().remove().end(),i(".ninja-forms-field-"+a+"-list-option").each(function(){var n=i(this).find(".ninja-forms-field-list-option-label").val();if(o)var t=i(this).find(".ninja-forms-field-list-option-value").val();else var t=n;var r=this.id.replace("ninja_forms_field_"+a+"_list_option_","");i("#"+e).append('<option value="'+t+'" title="'+r+'">'+n+"</option>")}))})}),i(document).on("click",".ninja-forms-field-add-conditional",function(n){n.preventDefault();var e=this.id.replace("ninja_forms_field_","");e=e.replace("_add_conditional","");var t=i("#_form_id").val(),a=i(".ninja-forms-field-"+e+"-conditional").length;i.post(ajaxurl,{form_id:t,field_id:e,x:a,action:"ninja_forms_add_conditional"},function(n){i("#ninja_forms_field_"+e+"_conditionals").append(n)})}),i(document).on("click",".ninja-forms-field-remove-conditional",function(n){n.preventDefault();var e=this.id.replace("ninja_forms_field_","");e=e.replace("_remove_conditional","");var t=this.name;i("#ninja_forms_field_"+e+"_conditional_"+t).remove()}),i(document).on("click",".ninja-forms-field-add-cr",function(n){n.preventDefault();var e=this.id.replace("ninja_forms_field_","");e=e.replace("_add_cr","");var t=i("#_form_id").val(),a=this.name,o=i(".ninja-forms-field-"+e+"-conditional-"+a+"-cr").length;i.post(ajaxurl,{form_id:t,field_id:e,x:a,y:o,action:"ninja_forms_add_cr"},function(n){i("#ninja_forms_field_"+e+"_conditional_"+a+"_cr").append(n.new_html);var t="",o="";i(".ninja-forms-field-title").each(function(){t=this.innerHTML,t.length>30&&(t=t.substring(0,30)+"..."),o=this.id.replace("ninja_forms_field_",""),o=o.replace("_title",""),i(".ninja-forms-field-conditional-cr-field > option").each(function(){this.value==o&&(this.text="ID: "+o+" - "+t)})})})}),i(document).on("click",".ninja-forms-field-remove-cr",function(n){n.preventDefault();var e=this.id.replace("ninja_forms_field_","");e=e.replace("_remove_cr","");var t=this.name,a=this.rel;i("#ninja_forms_field_"+e+"_conditional_"+t+"_cr_"+a).remove()}),i(document).on("change",".ninja-forms-field-conditional-cr-field",function(){var n=this.id.replace("ninja_forms_field_","");n=n.replace("_cr_field","");var e=this.title.split("_"),t=e[0],a=e[1],o=this.value;""!=this.value?i.post(ajaxurl,{field_id:n,field_value:o,x:t,y:a,output_options:1,action:"ninja_forms_change_cr_field"},function(e){if(i("#ninja_forms_field_"+n+"_conditional_"+t+"_cr_"+a+"_value").prop("innerHTML",e.new_html),"list"==e.new_type){var r=nfFields.get(o);if("undefined"!=typeof r.get("list")&&"undefined"!==r.get("list").options){var l=0;i('select[name="ninja_forms_field_'+n+"\\[conditional\\]\\["+t+"\\]\\[cr\\]\\["+a+'\\]\\[value\\]"]').find("option").remove().end(),_.each(r.get("list").options,function(e){var o=e.label,c=e.value;e.calc;0==r.get("list_show_value")&&(c=o),i('select[name="ninja_forms_field_'+n+"\\[conditional\\]\\["+t+"\\]\\[cr\\]\\["+a+'\\]\\[value\\]"]').append('<option value="'+c+'" title="'+l+'">'+o+"</option>"),l++})}i(".ninja-forms-field-"+o+"-list-option").length>0&&(i('select[name="ninja_forms_field_'+n+"\\[conditional\\]\\["+t+"\\]\\[cr\\]\\["+a+'\\]\\[value\\]"]').find("option").remove().end(),i(".ninja-forms-field-"+o+"-list-option").each(function(){var e=i(this).find(".ninja-forms-field-list-option-label").val();if(1==i("#ninja_forms_field_"+o+"_list_show_value").prop("checked"))var r=i(this).find(".ninja-forms-field-list-option-value").val();else var r=e;var l=this.id.replace("ninja_forms_field_"+o+"_list_option_","");i('select[name="ninja_forms_field_'+n+"\\[conditional\\]\\["+t+"\\]\\[cr\\]\\["+a+'\\]\\[value\\]"]').append('<option value="'+r+'" title="'+l+'">'+e+"</option>")}))}}):i("#ninja_forms_field_"+n+"_conditional_"+t+"_cr_"+a+"_value").prop("innerHTML","")}),i(document).on("change",".ninja-forms-notification-conditional-cr-field",function(){var n=this.id.replace("ninja_forms_field_","");n=n.replace("_cr_field","");var e=this.title.split("_"),t=e[0],a=e[1],o=this.value;""!=this.value?i.post(ajaxurl,{field_id:n,field_value:o,x:t,y:a,output_options:1,action:"ninja_forms_change_cr_field"},function(e){i("#ninja_forms_field_"+n+"_conditional_"+t+"_cr_"+a+"_value").prop("innerHTML",e.new_html),"list"==e.new_type&&i(".ninja-forms-field-"+o+"-list-option").each(function(){var e=i(this).find(".ninja-forms-field-list-option-label").val();if(1==i("#ninja_forms_field_"+o+"_list_show_value").prop("checked"))var r=i(this).find(".ninja-forms-field-list-option-value").val();else var r=e;var l=this.id.replace("ninja_forms_field_"+o+"_list_option_","");i('select[name="ninja_forms_field_'+n+"\\[conditional\\]\\["+t+"\\]\\[cr\\]\\["+a+'\\]\\[value\\]"]').append('<option value="'+r+'" title="'+l+'">'+e+"</option>")})}):i("#ninja_forms_field_"+n+"_conditional_"+t+"_cr_"+a+"_value").prop("innerHTML","")}),i(document).on("addField.clAdd",function(n,e){i(".ninja-forms-field-conditional-cr-field").each(function(){i(this).append('<option value="'+e.new_id+'">'+e.new_type+"</option>")})}),i(document).on("removeField.clRemove",function(n,e){i(".ninja-forms-field-conditional-cr-field").each(function(){i(this).children("option").each(function(){this.value==e&&i(this).remove()})})})});